<!DOCTYPE html>
<html lang="es" data-theme="light">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AgroTasker - Dashboard</title>
    <!-- Fuentes de Google -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <!-- Material Icons -->
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons+Outlined" rel="stylesheet">
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons+Round" rel="stylesheet">
    <!-- Chart.js y plugins -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels"></script>
    <!-- MQTT.js para la conexión MQTT -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mqtt/4.3.7/mqtt.min.js"></script>
    <!-- TensorFlow.js para predicciones -->
    <script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs"></script>
    <!-- CSS personalizado -->
    <link rel="stylesheet" href="css/styles.css">
    <link rel="stylesheet" href="css/modern.css">
    <link rel="stylesheet" href="css/dark-theme.css">
    <link rel="stylesheet" href="css/animations.css">
    <link rel="stylesheet" href="css/components.css">
    <link rel="stylesheet" href="css/charts.css">
</head>
<body>
    <!-- Toggle Modo Oscuro -->
    <button class="theme-toggle" id="theme-toggle">
        <span class="material-icons">dark_mode</span>
    </button>

    <div class="container">
        <!-- Cabecera -->
        <header class="dashboard-header">
            <h1><span class="material-icons">eco</span> AgroTasker</h1>
            <p class="subtitle">Monitoreo de Cultivo de Mango</p>
            <div class="connection-status">
                <span id="connection-indicator"></span>
                <span id="connection-text">Conectando...</span>
            </div>
            <div class="controls">
                <button class="button" id="export-data">
                    <span class="material-icons">download</span>
                    Exportar Datos
                </button>
                <button class="button" id="refresh-data">
                    <span class="material-icons">refresh</span>
                    Actualizar
                </button>
            </div>
        </header>

        <!-- Panel de Datos en Tiempo Real -->
        <section class="real-time-data">
            <div class="sensor-card" id="ph-card">
                <h3>pH del Suelo</h3>
                <div class="sensor-value">
                    <span id="ph-value">--</span>
                    <span class="unit">pH</span>
                </div>
                <div class="gauge-container">
                    <canvas id="ph-gauge"></canvas>
                </div>
            </div>

            <div class="sensor-card" id="temp-card">
                <h3>Temperatura</h3>
                <div class="sensor-value">
                    <span id="temp-value">--</span>
                    <span class="unit">°C</span>
                </div>
                <div class="gauge-container">
                    <canvas id="temp-gauge"></canvas>
                </div>
            </div>

            <div class="sensor-card" id="humidity-card">
                <h3>Humedad del Suelo</h3>
                <div class="sensor-value">
                    <span id="humidity-value">--</span>
                    <span class="unit">%</span>
                </div>
                <div class="gauge-container">
                    <canvas id="humidity-gauge"></canvas>
                </div>
            </div>
        </section>

        <!-- Panel de Gráficas -->
        <section class="charts-section">
            <div class="charts-grid">
                <div class="chart-card">
                    <div class="chart-header">
                        <h3>Humedad del Suelo</h3>
                        <div class="chart-controls">
                            <button class="btn-icon" data-chart="soilMoisture">
                                <span class="material-icons">fullscreen</span>
                            </button>
                        </div>
                    </div>
                    <div class="chart-container">
                        <canvas id="soilMoistureChart"></canvas>
                    </div>
                </div>

                <div class="chart-card">
                    <div class="chart-header">
                        <h3>Temperatura del Suelo</h3>
                        <div class="chart-controls">
                            <button class="btn-icon" data-chart="soilTemperature">
                                <span class="material-icons">fullscreen</span>
                            </button>
                        </div>
                    </div>
                    <div class="chart-container">
                        <canvas id="soilTempChart"></canvas>
                    </div>
                </div>

                <div class="chart-card">
                    <div class="chart-header">
                        <h3>Conductividad Eléctrica</h3>
                        <div class="chart-controls">
                            <button class="btn-icon" data-chart="conductivity">
                                <span class="material-icons">fullscreen</span>
                            </button>
                        </div>
                    </div>
                    <div class="chart-container">
                        <canvas id="conductivityChart"></canvas>
                    </div>
                </div>

                <div class="chart-card">
                    <div class="chart-header">
                        <h3>pH del Suelo</h3>
                        <div class="chart-controls">
                            <button class="btn-icon" data-chart="ph">
                                <span class="material-icons">fullscreen</span>
                            </button>
                        </div>
                    </div>
                    <div class="chart-container">
                        <canvas id="phChart"></canvas>
                    </div>
                </div>
            </div>
        </section>

        <!-- Panel de Estadísticas -->
        <section class="stats-section">
            <h2><span class="material-icons">analytics</span> Estadísticas</h2>
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-title">pH Promedio (24h)</div>
                    <div class="stat-value" id="ph-avg">--</div>
                </div>
                <div class="stat-card">
                    <div class="stat-title">Temperatura Máxima</div>
                    <div class="stat-value" id="temp-max">--</div>
                </div>
                <div class="stat-card">
                    <div class="stat-title">Humedad Promedio</div>
                    <div class="stat-value" id="humidity-avg">--</div>
                </div>
                <div class="stat-card">
                    <div class="stat-title">Tiempo desde último riego</div>
                    <div class="stat-value" id="last-watering">--</div>
                </div>
            </div>
        </section>

        <!-- Panel de Alertas -->
        <section class="alerts-section">
            <h2><span class="material-icons">warning</span> Alertas y Recomendaciones</h2>
            <div id="alerts-container">
                <!-- Las alertas se insertarán aquí dinámicamente -->
            </div>
        </section>

        <!-- Panel de Predicciones -->
        <section class="predictions-section">
            <h2><span class="material-icons">trending_up</span> Predicciones</h2>
            <div class="chart-container">
                <canvas id="prediction-chart"></canvas>
            </div>
            <div id="recommendations-container">
                <!-- Las recomendaciones se generarán dinámicamente -->
            </div>
        </section>

        <!-- Control de Riego -->
        <section class="irrigation-control-section">
            <h2><span class="material-icons">water_drop</span> Control de Riego</h2>
            <div class="irrigation-controls">
                <button id="irrigation-toggle" class="button">
                    <span class="material-icons">water_off</span>
                    Iniciar Riego
                </button>
                <div class="irrigation-schedule">
                    <h3>Programar Riego</h3>
                    <div class="schedule-form">
                        <input type="time" id="schedule-time" />
                        <input type="number" id="schedule-duration" placeholder="Duración (minutos)" min="1" max="120" />
                        <div class="schedule-days">
                            <label><input type="checkbox" class="schedule-day" value="mon">Lun</label>
                            <label><input type="checkbox" class="schedule-day" value="tue">Mar</label>
                            <label><input type="checkbox" class="schedule-day" value="wed">Mié</label>
                            <label><input type="checkbox" class="schedule-day" value="thu">Jue</label>
                            <label><input type="checkbox" class="schedule-day" value="fri">Vie</label>
                            <label><input type="checkbox" class="schedule-day" value="sat">Sáb</label>
                            <label><input type="checkbox" class="schedule-day" value="sun">Dom</label>
                        </div>
                        <button id="add-schedule" class="button">
                            <span class="material-icons">add</span>
                            Agregar Programación
                        </button>
                    </div>
                    <div id="schedules-container">
                        <!-- Las programaciones se generarán dinámicamente -->
                    </div>
                </div>
            </div>
        </section>

        <!-- Calendario de Riego -->
        <section class="calendar-section">
            <h2><span class="material-icons">calendar_today</span> Calendario de Riego</h2>
            <div class="controls">
                <button class="button" id="prev-month">
                    <span class="material-icons">chevron_left</span>
                </button>
                <span id="current-month">Octubre 2025</span>
                <button class="button" id="next-month">
                    <span class="material-icons">chevron_right</span>
                </button>
            </div>
            <div class="calendar-grid" id="calendar-grid">
                <!-- Los días se generarán dinámicamente -->
            </div>
        </section>

        <!-- Panel de Notificaciones -->
        <section class="notifications-section">
            <h2><span class="material-icons">notifications</span> Notificaciones</h2>
            <div id="notifications-container">
                <!-- Las notificaciones se generarán dinámicamente -->
            </div>
        </section>
    </div>

    <!-- JavaScript personalizado -->
    <script type="module" src="js/auth.js"></script>
    <script type="module" src="js/mqtt-client.js"></script>
    <script type="module" src="js/notifications.js"></script>
    <script type="module" src="js/predictions.js"></script>
    <script type="module" src="js/charts.js"></script>
    <script type="module" src="js/statistics.js"></script>
    <script type="module" src="js/irrigation-control.js"></script>
    <script type="module" src="js/calendar.js"></script>
    <script type="module" src="js/theme.js"></script>
    <script type="module" src="js/app.js"></script>
</body>
</html>